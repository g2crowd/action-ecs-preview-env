{
  "containerDefinitions":[
    {
      "name":"app",
      "image":"${env:PRENV_IMAGE}",
      "portMappings":[
        {
          "containerPort":3000,
          "hostPort":3000,
          "protocol":"tcp"
        }
      ],
      "essential":true,
      "command":[
        "web",
        "staging"
      ],
      "environment":[
        {
          "name":"AWS_REGION",
          "value":"us-east-1"
        },
        {
          "name":"RACK_ENV",
          "value":"production"
        },
        {
          "name":"RAILS_ENV",
          "value":"staging"
        },
        {
          "name":"REDIS_URL",
          "value":"redis://127.0.0.1:6379/0"
        },
        {
          "name":"MEMCACHED_URL",
          "value":"127.0.0.1:11211"
        },
        {
          "name":"PORT",
          "value":"3000"
        },
        {
          "name":"APP_NAME",
          "value":"prenv"
        },
        {
          "name":"ADMIN_HOST",
          "value":"${env:PRENV_DNS_NAME}"
        },
        {
          "name":"CANONICAL_HOST",
          "value":"${env:PRENV_DNS_NAME}"
        },
        {
          "name":"DEFAULT_URL_HOST",
          "value":"${env:PRENV_DNS_NAME}"
        },
        {
          "name":"HEROKU_APP_NAME",
          "value":"${env:PRENV_STACK_NAME}"
        },
        {
          "name":"WWW_HOST",
          "value":"${env:PRENV_DNS_NAME}"
        }
      ],
      "secrets":[
        {
          "name":"DATABASE_URL",
          "valueFrom":"${env:PRENV_DATABASE_URL}"
        }
      ],
      "logConfiguration":{
        "logDriver":"awslogs",
        "options":{
          "awslogs-group":"prenv-ue",
          "awslogs-region":"us-east-1",
          "awslogs-stream-prefix":"ue/app"
        }
      }
    },
    {
      "name":"redis",
      "image":"redis:6.2.6",
      "essential":true,
      "logConfiguration":{
        "logDriver":"awslogs",
        "options":{
          "awslogs-group":"prenv-ue",
          "awslogs-region":"us-east-1",
          "awslogs-stream-prefix":"ue/redis"
        }
      }
    },
    {
      "name":"memcached",
      "image":"memcached:1.6.12",
      "essential":true,
      "logConfiguration":{
        "logDriver":"awslogs",
        "options":{
          "awslogs-group":"prenv-ue",
          "awslogs-region":"us-east-1",
          "awslogs-stream-prefix":"ue/redis"
        }
      }
    },
    {
      "name":"web",
      "image":"235236588722.dkr.ecr.us-east-1.amazonaws.com/nginx:dev-web_ssl_certs",
      "portMappings":[
        {
          "containerPort":443,
          "hostPort":443,
          "protocol":"tcp"
        }
      ],
      "essential":true,
      "environment":[
        {
          "name":"WEB_HOSTNAME",
          "value":"_"
        },
        {
          "name":"APP_HOSTNAME",
          "value":"127.0.0.1"
        },
        {
          "name":"ENABLE_CDN",
          "value":"true"
        },
        {
          "name":"ENABLE_SSL",
          "value":"true"
        },
        {
          "name":"LIMIT_ACCESS_LOGS",
          "value":"false"
        }
      ],
      "dependsOn":[
        {
          "containerName":"app",
          "condition":"START"
        }
      ],
      "logConfiguration":{
        "logDriver":"awslogs",
        "options":{
          "awslogs-group":"prenv-ue",
          "awslogs-region":"us-east-1",
          "awslogs-stream-prefix":"ue/web"
        }
      }
    }
  ],
  "family":"${env:PRENV_TASK_FAMILY}",
  "taskRoleArn":"arn:aws:iam::683046045338:role/ue_role",
  "executionRoleArn":"arn:aws:iam::683046045338:role/ue_role",
  "networkMode":"awsvpc",
  "requiresCompatibilities":[
    "FARGATE"
  ],
  "cpu":"1024",
  "memory":"2048"
}
